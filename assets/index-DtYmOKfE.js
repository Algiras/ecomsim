import{r as c,a as Me,R as O,A as Ie,b as Ee,B as Re,X as Z,Y as Q,T as ee,c as Ae,C as Fe,L as Be,d as te,e as De}from"./charts-CSEo9cJk.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const i of a.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function s(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerPolicy&&(a.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?a.credentials="include":o.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(o){if(o.ep)return;o.ep=!0;const a=s(o);fetch(o.href,a)}})();var ce={exports:{}},W={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var We=c,He=Symbol.for("react.element"),_e=Symbol.for("react.fragment"),$e=Object.prototype.hasOwnProperty,Le=We.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,Oe={key:!0,ref:!0,__self:!0,__source:!0};function de(e,n,s){var r,o={},a=null,i=null;s!==void 0&&(a=""+s),n.key!==void 0&&(a=""+n.key),n.ref!==void 0&&(i=n.ref);for(r in n)$e.call(n,r)&&!Oe.hasOwnProperty(r)&&(o[r]=n[r]);if(e&&e.defaultProps)for(r in n=e.defaultProps,n)o[r]===void 0&&(o[r]=n[r]);return{$$typeof:He,type:e,key:a,ref:i,props:o,_owner:Le.current}}W.Fragment=_e;W.jsx=de;W.jsxs=de;ce.exports=W;var t=ce.exports,G={},se=Me;G.createRoot=se.createRoot,G.hydrateRoot=se.hydrateRoot;function Ge(e,n,s){return Math.max(n,Math.min(s,e))}function Ue(e,n=20){if(!e||e.length===0)return[];const s=[...e].sort((a,i)=>a-i),r=s.reduce((a,i)=>a+i,0);if(r===0)return[];const o=[{population:0,wealth:0}];for(let a=1;a<=n;a++){const i=Math.floor(a/n*s.length),l=s.slice(0,i).reduce((u,d)=>u+d,0);o.push({population:a/n*100,wealth:l/r*100})}return o}const C=[{threshold:0,color:[220,38,38]},{threshold:100,color:[234,88,12]},{threshold:300,color:[100,116,139]},{threshold:800,color:[59,130,246]},{threshold:2e3,color:[6,182,212]},{threshold:5e3,color:[234,179,8]},{threshold:1e4,color:[251,191,36]}];function ue(e){const n=Math.max(0,e);let s=C[0],r=C[C.length-1];for(let d=0;d<C.length-1;d++)if(n>=C[d].threshold&&n<C[d+1].threshold){s=C[d],r=C[d+1];break}const o=r.threshold-s.threshold,a=o>0?(n-s.threshold)/o:1,i=Math.round(s.color[0]+(r.color[0]-s.color[0])*a),l=Math.round(s.color[1]+(r.color[1]-s.color[1])*a),u=Math.round(s.color[2]+(r.color[2]-s.color[2])*a);return`rgb(${i},${l},${u})`}const q={food:"#22c55e",housing:"#f59e0b",tech:"#6366f1",luxury:"#ec4899"},qe=800,ze=600,Ye=4;function Ve(e,n,s,r){for(const o of n)o.alive&&Ke(e,o,o.id===s,r)}function Ke(e,n,s,r){const{x:o,y:a,state:i,wealth:l,happiness:u,unrest:d,employed:f,isOwner:h,age:m}=n,p=Ye;e.save(),d>.5?(e.shadowColor="rgba(239,68,68,0.7)",e.shadowBlur=8):l>5e3&&(e.shadowColor="rgba(251,191,36,0.5)",e.shadowBlur=6);const g=ue(l);if(e.beginPath(),h||i==="owner"?(e.moveTo(o,a-p*1.4),e.lineTo(o+p*1,a),e.lineTo(o,a+p*1.4),e.lineTo(o-p*1,a),e.closePath()):i==="child"||m<18*52?e.arc(o,a,p*.65,0,Math.PI*2):i==="retired"?e.rect(o-p*.9,a-p*.9,p*1.8,p*1.8):e.arc(o,a,p,0,Math.PI*2),e.fillStyle=g,e.fill(),i==="unemployed"?(e.strokeStyle="#ef4444",e.lineWidth=1.5,e.setLineDash([2,2]),e.stroke(),e.setLineDash([])):(f||h)&&(e.strokeStyle="rgba(255,255,255,0.6)",e.lineWidth=1,e.stroke()),l<100&&i!=="child"){const v=.3+.3*Math.sin(r*.1);e.strokeStyle=`rgba(239,68,68,${v})`,e.lineWidth=2,e.setLineDash([]),e.beginPath(),e.arc(o,a,p+3,0,Math.PI*2),e.stroke()}s&&(e.strokeStyle="#ffffff",e.lineWidth=2,e.setLineDash([]),e.beginPath(),e.arc(o,a,p+4,0,Math.PI*2),e.stroke()),e.restore()}function Je(e,n,s,r=.12){e.save(),e.lineWidth=.5;for(const o of n){if(!o.alive||!o.employed||!o.employerId)continue;const a=s.find(i=>i.id===o.employerId);a&&(e.beginPath(),e.strokeStyle=`rgba(99,102,241,${r})`,e.moveTo(o.x,o.y),e.lineTo(a.x,a.y),e.stroke())}e.restore()}function Xe(e,n,s){for(const r of n)r.alive&&Ze(e,r,s)}function Ze(e,n,s){const{x:r,y:o,sector:a,employeeCount:i,radius:l,pulse:u,dominance:d,capital:f}=n,h=q[a]||"#94a3b8";e.save(),d>.4?(e.shadowColor=h,e.shadowBlur=15+d*20):f>2e3&&(e.shadowColor=h,e.shadowBlur=8);const m=l||10;if(e.beginPath(),ne(e,r,o,m),e.fillStyle=h+"33",e.fill(),e.strokeStyle=h,e.lineWidth=2,e.stroke(),e.fillStyle=h,e.font=`${Math.max(8,m*.8)}px sans-serif`,e.textAlign="center",e.textBaseline="middle",e.fillText(Qe[a]||"?",r,o),i>0&&(e.fillStyle="rgba(0,0,0,0.7)",e.beginPath(),e.arc(r+m*.8,o-m*.8,6,0,Math.PI*2),e.fill(),e.fillStyle="#ffffff",e.font="7px sans-serif",e.fillText(i,r+m*.8,o-m*.8)),f<100){const p=.4+.4*Math.sin(s*.15);e.strokeStyle=`rgba(239,68,68,${p})`,e.lineWidth=2,e.beginPath(),ne(e,r,o,m+4),e.stroke()}e.restore()}function ne(e,n,s,r){e.beginPath();for(let o=0;o<6;o++){const a=Math.PI/3*o-Math.PI/6,i=n+r*Math.cos(a),l=s+r*Math.sin(a);o===0?e.moveTo(i,l):e.lineTo(i,l)}e.closePath()}const Qe={food:"ðŸŒ¾",housing:"ðŸ ",tech:"ðŸ’»",luxury:"ðŸ’Ž"};function et(e,n,s,r){e.save();for(const o of n){if(!o.alive)continue;const a=q[o.sector]||"#94a3b8",i=30+o.employeeCount*5,l=e.createRadialGradient(o.x,o.y,0,o.x,o.y,i);l.addColorStop(0,a+"15"),l.addColorStop(1,"transparent"),e.fillStyle=l,e.beginPath(),e.arc(o.x,o.y,i,0,Math.PI*2),e.fill()}e.restore()}const E=[];function tt(e,n){for(let s=0;s<6;s++){const r=Math.PI*2/6*s;E.push({type:"sparkle",x:e,y:n,vx:Math.cos(r)*2,vy:Math.sin(r)*2,life:1,color:"#22c55e",size:3})}}function st(e,n){for(let s=0;s<8;s++){const r=Math.random()*Math.PI*2;E.push({type:"fade",x:e+(Math.random()-.5)*10,y:n+(Math.random()-.5)*10,vx:Math.cos(r)*1.5,vy:Math.sin(r)*1.5,life:1,color:"#ef4444",size:2})}}function nt(e){for(let n=E.length-1;n>=0;n--){const s=E[n];switch(e.save(),e.globalAlpha=s.life,s.type){case"sparkle":e.fillStyle=s.color,e.beginPath(),e.arc(s.x,s.y,s.size*s.life,0,Math.PI*2),e.fill(),s.x+=s.vx,s.y+=s.vy,s.vx*=.95,s.vy*=.95,s.life-=.04;break;case"fade":e.fillStyle=s.color,e.beginPath(),e.arc(s.x,s.y,s.size,0,Math.PI*2),e.fill(),s.x+=s.vx,s.y+=s.vy,s.life-=.06;break;case"wave":e.strokeStyle=s.color,e.lineWidth=1.5,e.beginPath(),e.arc(s.x,s.y,s.radius,0,Math.PI*2),e.stroke(),s.radius=s.radius+(s.maxRadius-s.radius)*.08,s.life-=.03;break}e.restore(),s.life<=0&&E.splice(n,1)}}function ot({simState:e,onAgentClick:n,selectedAgentId:s}){const r=c.useRef(null),o=c.useRef(null),a=c.useRef(0),i=c.useRef(new Set),l=c.useCallback(()=>{const d=r.current;if(!d)return;const f=d.getContext("2d");a.current++;const h=a.current;if(f.fillStyle="#0a0a0f",f.fillRect(0,0,d.width,d.height),!e){f.fillStyle="#334155",f.font="14px monospace",f.textAlign="center",f.fillText("Initializing simulation...",d.width/2,d.height/2);return}const{agents:m=[],businesses:p=[]}=e,g=new Set(m.filter(b=>b.alive).map(b=>b.id)),v=i.current;for(const b of v)if(!g.has(b)){const w=m.find(k=>k.id===b);w&&st(w.x,w.y)}for(const b of g)if(!v.has(b)){const w=m.find(k=>k.id===b);w&&tt(w.x,w.y)}i.current=g,et(f,p,d.width,d.height),Je(f,m,p),Xe(f,p,h),Ve(f,m,s,h),nt(f),o.current=requestAnimationFrame(l)},[e,s]);c.useEffect(()=>(o.current=requestAnimationFrame(l),()=>{o.current&&cancelAnimationFrame(o.current)}),[l]);const u=c.useCallback(d=>{if(!(e!=null&&e.agents)||!n)return;const f=r.current,h=f.getBoundingClientRect(),m=f.width/h.width,p=f.height/h.height,g=(d.clientX-h.left)*m,v=(d.clientY-h.top)*p;let b=null,w=12;for(const k of e.agents){if(!k.alive)continue;const T=Math.sqrt((k.x-g)**2+(k.y-v)**2);T<w&&(w=T,b=k)}n(b)},[e,n]);return t.jsx("canvas",{ref:r,width:qe,height:ze,className:"w-full h-full cursor-crosshair",style:{imageRendering:"pixelated",display:"block"},onClick:u})}function S({label:e,value:n,unit:s="",trend:r,color:o="#6366f1",history:a=[],format:i="number"}){const l=c.useMemo(()=>i==="percent"?(n*100).toFixed(1)+"%":i==="currency"?"$"+oe(n):i==="index"?n.toFixed(1):oe(n),[n,i]),u=a.slice(-40).map((d,f)=>({i:f,v:d}));return t.jsxs("div",{className:"bg-[#12121a] border border-[#1e1e2e] rounded-lg p-3 flex flex-col gap-1",children:[t.jsx("div",{className:"text-[#64748b] text-xs uppercase tracking-wider font-mono",children:e}),t.jsxs("div",{className:"flex items-end gap-2",children:[t.jsx("span",{className:"text-white text-xl font-bold font-mono",style:{color:o},children:l}),s&&t.jsx("span",{className:"text-[#64748b] text-xs mb-1",children:s}),r!==void 0&&t.jsxs("span",{className:`text-xs mb-1 ${r>=0?"text-green-400":"text-red-400"}`,children:[r>=0?"â†‘":"â†“"," ",Math.abs(r*100).toFixed(1),"%"]})]}),u.length>5&&t.jsx("div",{className:"h-8 w-full",children:t.jsx(O,{width:"100%",height:"100%",children:t.jsx(Ie,{data:u,margin:{top:0,right:0,bottom:0,left:0},children:t.jsx(Ee,{type:"monotone",dataKey:"v",stroke:o,fill:o+"22",strokeWidth:1,dot:!1,isAnimationActive:!1})})})})]})}function rt({prices:e,supply:n,demand:s}){return t.jsxs("div",{className:"bg-[#12121a] border border-[#1e1e2e] rounded-lg p-3",children:[t.jsx("div",{className:"text-[#64748b] text-xs uppercase tracking-wider font-mono mb-2",children:"Market Prices"}),t.jsx("div",{className:"grid grid-cols-2 gap-1.5",children:Object.entries(e||{}).map(([r,o])=>{const a=(n==null?void 0:n[r])||0,i=(s==null?void 0:s[r])||0,l=i>a?"text-red-400":"text-green-400",u=i>a?"â†‘":"â†“";return t.jsxs("div",{className:"flex justify-between items-center text-xs",children:[t.jsx("span",{style:{color:q[r]},className:"font-mono capitalize",children:r}),t.jsxs("span",{className:`font-mono font-bold ${l}`,children:["$",o.toFixed(1)," ",u]})]},r)})})]})}function at({value:e}){const n=(e*100).toFixed(1),s=e>.5?"#ef4444":e>.35?"#f59e0b":"#22c55e";return t.jsxs("div",{className:"bg-[#12121a] border border-[#1e1e2e] rounded-lg p-3",children:[t.jsxs("div",{className:"text-[#64748b] text-xs uppercase tracking-wider font-mono mb-2",children:["Inequality (Gini) â€” ",n]}),t.jsx("div",{className:"w-full bg-[#1e1e2e] rounded-full h-2 mb-1",children:t.jsx("div",{className:"h-2 rounded-full transition-all duration-500",style:{width:`${Math.min(100,e*100)}%`,backgroundColor:s}})}),t.jsxs("div",{className:"flex justify-between text-[10px] text-[#475569]",children:[t.jsx("span",{children:"Perfect Equality (0)"}),t.jsx("span",{children:"Total Inequality (1)"})]})]})}function it({event:e}){return t.jsxs("div",{className:"bg-[#1e1e2e] border border-[#334155] rounded px-2 py-1 text-xs flex items-center gap-1",children:[t.jsx("span",{children:e.icon}),t.jsx("span",{className:"text-[#e2e8f0] font-mono",children:e.name})]})}function lt({metrics:e,market:n,activeEvents:s=[]}){if(!e)return t.jsx("div",{className:"text-[#475569] text-sm font-mono p-4",children:"Loading metrics..."});const{history:r={}}=e;return t.jsxs("div",{className:"flex flex-col gap-2 overflow-y-auto h-full",children:[s.length>0&&t.jsx("div",{className:"flex flex-wrap gap-1 px-1",children:s.map(o=>t.jsx(it,{event:o},o.id))}),t.jsxs("div",{className:"text-[#475569] text-xs font-mono px-1",children:["Year ",e.year," Â· Tick ",e.tick," Â· Pop ",e.population]}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx(S,{label:"GDP",value:e.gdp,format:"currency",trend:e.gdpGrowth,color:"#6366f1",history:r.gdp||[]}),t.jsx(S,{label:"Unemployment",value:e.unemployment,format:"percent",color:e.unemployment>.15?"#ef4444":"#22c55e",history:r.unemployment||[]}),t.jsx(S,{label:"Inflation (CPI)",value:e.cpi,format:"index",color:e.cpi>120?"#f97316":"#e2e8f0",history:r.cpi||[]}),t.jsx(S,{label:"Avg Wage",value:e.avgWage,format:"currency",color:"#06b6d4"})]}),t.jsx(at,{value:e.gini}),t.jsx(rt,{prices:n==null?void 0:n.prices,supply:n==null?void 0:n.supply,demand:n==null?void 0:n.demand}),t.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.jsx(S,{label:"Poverty Rate",value:e.povertyRate,format:"percent",color:e.povertyRate>.25?"#ef4444":"#94a3b8"}),t.jsx(S,{label:"Social Unrest",value:e.socialUnrest,format:"percent",color:e.socialUnrest>.5?"#ef4444":"#94a3b8",history:r.unrest||[]}),t.jsx(S,{label:"Businesses",value:e.businessCount,color:"#f59e0b"}),t.jsx(S,{label:"Gov Debt",value:Math.abs(e.govDebt||0),format:"currency",color:(e.govDebt||0)>1e3?"#ef4444":"#64748b"})]})]})}function oe(e){return e==null||isNaN(e)?"0":Math.abs(e)>=1e9?(e/1e9).toFixed(1)+"B":Math.abs(e)>=1e6?(e/1e6).toFixed(1)+"M":Math.abs(e)>=1e3?(e/1e3).toFixed(1)+"K":Math.round(e).toString()}const ct=[{id:"incomeTax",name:"Income Tax",category:"fiscal",type:"slider",min:0,max:.6,step:.01,format:"percent",icon:"ðŸ›ï¸",description:"Tax on worker wages. Funds public spending. Too high reduces work incentive.",tradeoff:"â†‘ Revenue but â†“ Worker take-home pay"},{id:"corporateTax",name:"Corporate Tax",category:"fiscal",type:"slider",min:0,max:.5,step:.01,format:"percent",icon:"ðŸ¢",description:"Tax on business profits. High rates may deter investment.",tradeoff:"â†‘ Revenue but â†“ Business investment"},{id:"minWage",name:"Minimum Wage",category:"labor",type:"slider",min:0,max:30,step:1,format:"currency",icon:"ðŸ’¼",description:"Floor on wages. Protects workers but may price out low-skill labor.",tradeoff:"â†‘ Worker wages but â†‘ Unemployment risk"},{id:"ubi",name:"Universal Basic Income",category:"welfare",type:"slider",min:0,max:500,step:10,format:"currency",icon:"ðŸŽ",description:"Unconditional payment to all citizens. Eliminates poverty floor. Very expensive.",tradeoff:"â†‘ Equality but â†‘â†‘ Government spending"},{id:"interestRate",name:"Interest Rate",category:"monetary",type:"slider",min:0,max:.2,step:.005,format:"percent",icon:"ðŸ¦",description:"Cost of borrowing money. High rates fight inflation but slow growth.",tradeoff:"â†‘ Fights inflation but â†“ Business investment"},{id:"antiMonopoly",name:"Anti-Monopoly Laws",category:"regulation",type:"toggle",icon:"âš–ï¸",description:"Break up businesses that dominate a market. Prevents price gouging.",tradeoff:"â†‘ Competition but â†“ Economies of scale"},{id:"educationFunding",name:"Education Spending",category:"public",type:"slider",min:0,max:1,step:.05,format:"percent",icon:"ðŸ“š",description:"Invests in workforce quality over time. Slow payoff, lasting effect.",tradeoff:"â†‘ Long-term productivity but â†‘ Government spending now"},{id:"unemploymentBenefit",name:"Unemployment Benefits",category:"welfare",type:"slider",min:0,max:300,step:10,format:"currency",icon:"ðŸ›¡ï¸",description:"Payments to unemployed workers. Maintains demand but may reduce job search urgency.",tradeoff:"â†‘ Stability but may â†‘ Unemployment duration"},{id:"priceControlFood",name:"Food Price Controls",category:"regulation",type:"toggle",icon:"ðŸŒ¾",description:"Caps food prices to protect the poor. May cause shortages if price is too low.",tradeoff:"â†‘ Affordability but â†“ Farm investment"},{id:"priceControlHousing",name:"Rent Controls",category:"regulation",type:"toggle",icon:"ðŸ ",description:"Limits housing rent increases. Helps existing tenants, discourages new supply.",tradeoff:"â†‘ Affordability but â†“ New housing construction"},{id:"printMoney",name:"Quantitative Easing",category:"monetary",type:"slider",min:0,max:50,step:1,format:"number",icon:"ðŸ–¨ï¸",description:"Inject money into the economy. Boosts demand but causes inflation.",tradeoff:"â†‘ Short-term demand but â†‘â†‘ Inflation risk"},{id:"publicHealthcare",name:"Public Healthcare",category:"public",type:"toggle",icon:"ðŸ¥",description:"Government-funded health. Improves health, reduces death rate, increases happiness.",tradeoff:"â†‘ Health + happiness but â†‘â†‘ Government spending"},{id:"wealthTax",name:"Wealth Tax",category:"fiscal",type:"slider",min:0,max:.05,step:.001,format:"percent",icon:"ðŸ’Ž",description:"Annual tax on total wealth above threshold. Directly reduces inequality.",tradeoff:"â†‘ Equality but â†“ Capital accumulation"},{id:"openBorders",name:"Open Immigration",category:"labor",type:"toggle",icon:"ðŸŒ",description:"Allow skilled immigrants. Boosts labor supply and productivity, may suppress wages.",tradeoff:"â†‘ Productivity but â†‘ Job competition"},{id:"subsidiesFarming",name:"Farm Subsidies",category:"fiscal",type:"toggle",icon:"ðŸšœ",description:"Government support for food production. Lowers food prices but costs taxpayers.",tradeoff:"â†‘ Food supply + lower prices but â†‘ Spending"}],dt={fiscal:{label:"Fiscal Policy",color:"#3b82f6"},monetary:{label:"Monetary Policy",color:"#f59e0b"},labor:{label:"Labor Market",color:"#22c55e"},welfare:{label:"Welfare",color:"#ec4899"},regulation:{label:"Regulation",color:"#8b5cf6"},public:{label:"Public Services",color:"#06b6d4"}};function ut({policy:e,value:n,onChange:s}){const r=o=>e.format==="percent"?(o*100).toFixed(0)+"%":e.format==="currency"?"$"+o:o;return t.jsxs("div",{className:"group",children:[t.jsxs("div",{className:"flex justify-between items-center mb-1",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("span",{className:"text-sm",children:e.icon}),t.jsx("span",{className:"text-xs text-[#e2e8f0] font-mono",children:e.name})]}),t.jsx("span",{className:"text-xs font-bold font-mono text-[#6366f1]",children:r(n)})]}),t.jsx("input",{type:"range",min:e.min,max:e.max,step:e.step,value:n,onChange:o=>s(e.id,parseFloat(o.target.value)),className:"w-full h-1.5 rounded-full appearance-none cursor-pointer",style:{background:`linear-gradient(to right, #6366f1 0%, #6366f1 ${(n-e.min)/(e.max-e.min)*100}%, #1e1e2e ${(n-e.min)/(e.max-e.min)*100}%, #1e1e2e 100%)`},title:e.description}),t.jsx("div",{className:"hidden group-hover:block text-[10px] text-[#475569] mt-1 leading-tight",children:e.tradeoff})]})}function ft({policy:e,value:n,onChange:s}){return t.jsxs("div",{className:"flex items-center justify-between group",children:[t.jsxs("div",{className:"flex items-center gap-1.5",children:[t.jsx("span",{className:"text-sm",children:e.icon}),t.jsx("span",{className:"text-xs text-[#e2e8f0] font-mono",children:e.name})]}),t.jsx("button",{onClick:()=>s(e.id,!n),className:`relative w-9 h-5 rounded-full transition-colors duration-200 flex-shrink-0 ${n?"bg-[#6366f1]":"bg-[#334155]"}`,children:t.jsx("span",{className:`absolute top-0.5 w-4 h-4 bg-white rounded-full shadow transition-transform duration-200 ${n?"translate-x-4":"translate-x-0.5"}`})})]})}function ht({policies:e,onPolicyChange:n}){const[s,r]=c.useState("fiscal"),[o,a]=c.useState(!0),i=ct.filter(l=>l.category===s);return t.jsxs("div",{className:"flex flex-col h-full",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsx("h3",{className:"text-xs uppercase tracking-widest text-[#64748b] font-mono",children:"Policy Controls"}),t.jsx("button",{onClick:()=>a(!o),className:"text-[#475569] hover:text-[#e2e8f0] text-xs",children:o?"â–¼":"â–¶"})]}),o&&t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"flex flex-wrap gap-1 mb-3",children:Object.entries(dt).map(([l,u])=>t.jsx("button",{onClick:()=>r(l),className:`text-[10px] px-2 py-0.5 rounded font-mono transition-colors ${s===l?"text-white":"text-[#475569] hover:text-[#94a3b8]"}`,style:{backgroundColor:s===l?u.color+"33":"transparent",borderColor:u.color+"44",border:"1px solid"},children:u.label},l))}),t.jsx("div",{className:"flex flex-col gap-3 overflow-y-auto flex-1",children:i.map(l=>t.jsx("div",{children:l.type==="slider"?t.jsx(ut,{policy:l,value:(e==null?void 0:e[l.id])??0,onChange:n}):t.jsx(ft,{policy:l,value:(e==null?void 0:e[l.id])??!1,onChange:n})},l.id))})]})]})}const mt=[{label:"1Ã—",value:1,title:"Slow â€” watch individual agents"},{label:"5Ã—",value:5,title:"Normal play"},{label:"20Ã—",value:20,title:"Fast-forward"},{label:"Max",value:60,title:"Stress test"}];function pt({paused:e,speed:n,onPause:s,onResume:r,onReset:o,onSpeedChange:a,onScenarioOpen:i,onShockMe:l,scenarioName:u,year:d,narratorEnabled:f,narratorLoading:h,onNarratorToggle:m}){const[p,g]=c.useState(!1),v=()=>{navigator.clipboard&&(navigator.clipboard.writeText(window.location.href),g(!0),setTimeout(()=>g(!1),2e3))};return t.jsxs("header",{className:"flex items-center justify-between px-4 py-2 bg-[#0a0a0f] border-b border-[#1e1e2e] flex-wrap gap-2",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:"text-lg",children:"ðŸ¾"}),t.jsx("span",{className:"text-[#e2e8f0] font-bold font-mono text-sm hidden sm:block",children:"EconSim"})]}),t.jsxs("button",{onClick:i,className:"text-xs font-mono text-[#6366f1] hover:text-[#818cf8] border border-[#6366f133] hover:border-[#6366f166] rounded px-2 py-1 transition-colors",children:[u||"Free Market"," â–¾"]}),d!==void 0&&t.jsxs("span",{className:"text-[#475569] text-xs font-mono",children:["Year ",d]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"flex items-center gap-0.5 bg-[#12121a] border border-[#1e1e2e] rounded px-1",children:mt.map(b=>t.jsx("button",{onClick:()=>a(b.value),title:b.title,className:`text-xs font-mono px-2 py-1 rounded transition-colors ${n===b.value?"bg-[#6366f1] text-white":"text-[#64748b] hover:text-[#e2e8f0]"}`,children:b.label},b.value))}),t.jsx("button",{onClick:e?r:s,className:`flex items-center gap-1 text-xs font-mono px-3 py-1.5 rounded border transition-colors
            border-[#1e1e2e] text-[#e2e8f0] hover:border-[#6366f1] hover:text-[#6366f1]`,children:e?"â–¶ Play":"â¸ Pause"}),t.jsx("button",{onClick:o,className:`text-xs font-mono px-3 py-1.5 rounded border border-[#1e1e2e] text-[#64748b]
            hover:border-[#ef4444] hover:text-[#ef4444] transition-colors`,title:"Reset simulation",children:"â†º Reset"}),t.jsx("button",{onClick:l,className:`text-xs font-mono px-3 py-1.5 rounded border border-[#f59e0b33] text-[#f59e0b]
            hover:bg-[#f59e0b11] transition-colors`,title:"Trigger a random economic event",children:"âš¡ Shock"}),t.jsx("button",{onClick:v,className:`text-xs font-mono px-3 py-1.5 rounded border border-[#1e1e2e] text-[#64748b]
            hover:border-[#22c55e] hover:text-[#22c55e] transition-colors`,title:"Copy shareable link",children:p?"âœ“ Copied!":"ðŸ”— Share"}),t.jsx("button",{onClick:m,disabled:h,className:`text-xs font-mono px-3 py-1.5 rounded border transition-colors ${f?"border-[#06b6d4] text-[#06b6d4] bg-[#06b6d411]":"border-[#1e1e2e] text-[#475569] hover:border-[#06b6d4] hover:text-[#06b6d4]"} ${h?"opacity-50 cursor-wait":""}`,title:f?"Disable narration":"Enable AI narration (loads ~40MB model)",children:h?"â³ Loadingâ€¦":f?"ðŸ”Š Voice On":"ðŸ”‡ Voice"})]})]})}const U={freeMarket:{id:"freeMarket",name:"Free Market Utopia",subtitle:"No rules. Pure capitalism.",description:"Zero regulation. No minimum wage, no taxes, no safety net. Watch monopolies form naturally and see who wins â€” and who gets left behind.",icon:"ðŸ¦…",difficulty:"Observe",color:"#3b82f6",isHistorical:!1,policies:{incomeTax:0,corporateTax:0,minWage:0,ubi:0,interestRate:.02,antiMonopoly:!1,educationFunding:0,unemploymentBenefit:0,priceControlFood:!1,priceControlHousing:!1,printMoney:0,publicHealthcare:!1,wealthTax:0,openBorders:!1,subsidiesFarming:!1},agentCount:200,businessCount:20,wealthMultiplier:1.2,wealthInequality:1.5,avgSkill:.5,lesson:"Natural monopolies emerge quickly. The rich get richer. But GDP grows fast at first."},debtSpiral:{id:"debtSpiral",name:"The Debt Spiral",subtitle:"Borrowed too much. Now what?",description:"The government spent heavily on social programs. Debt is high, deficit is growing. Austerity or default â€” pick your poison.",icon:"ðŸ’¸",difficulty:"Hard",color:"#ef4444",isHistorical:!1,policies:{incomeTax:.45,corporateTax:.35,minWage:15,ubi:200,interestRate:.12,antiMonopoly:!0,educationFunding:.8,unemploymentBenefit:150,priceControlFood:!1,priceControlHousing:!1,printMoney:5,publicHealthcare:!0,wealthTax:.02,openBorders:!1,subsidiesFarming:!1},agentCount:200,businessCount:18,wealthMultiplier:.8,wealthInequality:.8,avgSkill:.55,startGovDebt:5e3,lesson:"Cutting programs causes pain now. Keeping them causes pain later. The political economy of austerity."},techDisruption:{id:"techDisruption",name:"Tech Disruption",subtitle:"Automation is coming for jobs.",description:"A stable, balanced economy. Then a tech breakthrough hits â€” half the jobs can be automated. Will you adapt or collapse?",icon:"ðŸ¤–",difficulty:"Medium",color:"#8b5cf6",isHistorical:!1,policies:{incomeTax:.28,corporateTax:.21,minWage:12,ubi:0,interestRate:.05,antiMonopoly:!1,educationFunding:.5,unemploymentBenefit:80,priceControlFood:!1,priceControlHousing:!1,printMoney:0,publicHealthcare:!1,wealthTax:0,openBorders:!1,subsidiesFarming:!1},agentCount:200,businessCount:20,wealthMultiplier:1,wealthInequality:1,avgSkill:.5,scheduledEvents:[{type:"techBreakthrough",atTick:200}],lesson:"Automation creates wealth but destroys jobs. UBI or retraining â€” which policy saves more people?"},greatDepression:{id:"greatDepression",name:"The Great Depression",subtitle:"October 1929. The markets have collapsed.",description:'GDP has fallen 30%. Unemployment is climbing toward 25%. Banks are failing daily. Hoover says "be patient." Do you agree?',icon:"ðŸ“‰",difficulty:"Very Hard",color:"#78716c",isHistorical:!0,era:"1929â€“1939 Â· United States",durationYears:15,policies:{incomeTax:.02,corporateTax:.12,minWage:0,ubi:0,interestRate:.06,antiMonopoly:!1,educationFunding:.1,unemploymentBenefit:0,priceControlFood:!1,priceControlHousing:!1,printMoney:0,publicHealthcare:!1,wealthTax:0,openBorders:!1,subsidiesFarming:!1},agentCount:200,businessCount:12,wealthMultiplier:.35,wealthInequality:2,avgSkill:.4,scheduledEvents:[{type:"recession",atTick:1},{type:"financialBubble",atTick:80}],lesson:"Austerity deepened the Depression. FDR's New Deal proved government spending could restart demand."},weimarHyperinflation:{id:"weimarHyperinflation",name:"Weimar Hyperinflation",subtitle:"A loaf of bread costs a wheelbarrow of cash.",description:"Post-WWI Germany is printing money to pay reparations. Inflation is doubling daily. The middle class is being wiped out. Can you stabilize the currency before society collapses?",icon:"ðŸ’¹",difficulty:"Expert",color:"#dc2626",isHistorical:!0,era:"1921â€“1924 Â· Germany",durationYears:10,policies:{incomeTax:.15,corporateTax:.1,minWage:0,ubi:0,interestRate:.01,antiMonopoly:!1,educationFunding:.2,unemploymentBenefit:0,priceControlFood:!0,priceControlHousing:!1,printMoney:40,publicHealthcare:!1,wealthTax:0,openBorders:!1,subsidiesFarming:!1},agentCount:180,businessCount:15,wealthMultiplier:.5,wealthInequality:1.8,avgSkill:.45,scheduledEvents:[],lesson:"Stopping hyperinflation requires cold turkey: halt money printing, issue new credible currency, accept short-term pain."},stagflation1970s:{id:"stagflation1970s",name:"1970s Stagflation",subtitle:"Inflation up. Unemployment up. Nothing works.",description:"OPEC's oil embargo just hit. Prices are surging but the economy is stagnating. Your standard policy tools are pointing in opposite directions. What do you do?",icon:"â›½",difficulty:"Hard",color:"#d97706",isHistorical:!0,era:"1973â€“1982 Â· United States",durationYears:12,policies:{incomeTax:.3,corporateTax:.48,minWage:8,ubi:0,interestRate:.06,antiMonopoly:!1,educationFunding:.4,unemploymentBenefit:100,priceControlFood:!1,priceControlHousing:!1,printMoney:8,publicHealthcare:!1,wealthTax:0,openBorders:!1,subsidiesFarming:!1},agentCount:200,businessCount:18,wealthMultiplier:.85,wealthInequality:1.1,avgSkill:.5,scheduledEvents:[{type:"cropFailure",atTick:20},{type:"recession",atTick:150}],lesson:"Stagflation broke Keynesian consensus. Volcker's painful rate hikes eventually worked â€” but cost millions their jobs."},crisisOf2008:{id:"crisisOf2008",name:"2008 Financial Crisis",subtitle:"Lehman just failed. The banks are frozen.",description:"The US housing bubble has burst. Banks are insolvent. Credit is frozen. The global economy is in freefall. Bail out the banks, let them fail, or something else?",icon:"ðŸ¦",difficulty:"Hard",color:"#7c3aed",isHistorical:!0,era:"2008â€“2015 Â· Global",durationYears:10,policies:{incomeTax:.28,corporateTax:.35,minWage:10,ubi:0,interestRate:.05,antiMonopoly:!1,educationFunding:.4,unemploymentBenefit:100,priceControlFood:!1,priceControlHousing:!1,printMoney:0,publicHealthcare:!1,wealthTax:0,openBorders:!1,subsidiesFarming:!1},agentCount:200,businessCount:16,wealthMultiplier:.7,wealthInequality:1.6,avgSkill:.5,scheduledEvents:[{type:"financialBubble",atTick:1},{type:"recession",atTick:30}],lesson:"Bailouts prevented a depression but rewarded recklessness. The political consequences lasted a decade."},japanLostDecade:{id:"japanLostDecade",name:"Japan's Lost Decade",subtitle:"Zero rates. Zero growth. Zero inflation.",description:"Japan's asset bubble burst in 1991. Interest rates are near zero. Stimulus packages come and go. Nothing works. Can you escape the deflationary trap that trapped Japan for 20 years?",icon:"ðŸ—¾",difficulty:"Expert",color:"#0891b2",isHistorical:!0,era:"1991â€“2010 Â· Japan",durationYears:15,policies:{incomeTax:.33,corporateTax:.38,minWage:6,ubi:0,interestRate:.005,antiMonopoly:!1,educationFunding:.6,unemploymentBenefit:80,priceControlFood:!1,priceControlHousing:!1,printMoney:2,publicHealthcare:!0,wealthTax:0,openBorders:!1,subsidiesFarming:!1},agentCount:200,businessCount:20,wealthMultiplier:.9,wealthInequality:.9,avgSkill:.65,scheduledEvents:[{type:"financialBubble",atTick:1},{type:"recession",atTick:10}],lesson:"Half-measures and zombie banks prolonged Japan's stagnation for 20 years. Swift, decisive action matters."},nordicMiracle:{id:"nordicMiracle",name:"Build the Nordic Model",subtitle:"High taxes. High trust. High happiness.",description:"You're building a new nation. Can you achieve the Nordic balance: low inequality, high productivity, strong safety net, and sustained growth? This is what success looks like.",icon:"ðŸŒ",difficulty:"Blueprint",color:"#059669",isHistorical:!0,era:"Reference Model Â· Scandinavia",durationYears:20,policies:{incomeTax:.45,corporateTax:.25,minWage:18,ubi:0,interestRate:.03,antiMonopoly:!0,educationFunding:.9,unemploymentBenefit:200,priceControlFood:!1,priceControlHousing:!1,printMoney:0,publicHealthcare:!0,wealthTax:.01,openBorders:!1,subsidiesFarming:!0},agentCount:200,businessCount:22,wealthMultiplier:1,wealthInequality:.7,avgSkill:.6,avgEducation:.65,scheduledEvents:[],lesson:"The Nordic model requires high institutional trust, universal services, AND open competitive markets. All three."}},fe=Object.values(U),xt=fe.filter(e=>!e.isHistorical),bt=fe.filter(e=>e.isHistorical);function gt({scenario:e,onSelect:n,current:s}){const r=s===e.id;return t.jsx("button",{onClick:()=>n(e.id),className:`w-full text-left p-4 rounded-xl border transition-all ${r?"":"border-[#1e1e2e] bg-[#12121a] hover:border-[#334155]"}`,style:{borderColor:r?e.color:void 0,backgroundColor:r?e.color+"10":void 0},children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("span",{className:"text-2xl",children:e.icon}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-0.5",children:[t.jsx("span",{className:"text-white font-bold text-sm",children:e.name}),t.jsx("span",{className:"text-[10px] px-1.5 py-0.5 rounded font-mono",style:{backgroundColor:e.color+"22",color:e.color},children:e.difficulty}),e.durationYears&&t.jsxs("span",{className:"text-[10px] px-1.5 py-0.5 rounded font-mono bg-[#1e1e2e] text-[#64748b]",children:[e.durationYears,"yr challenge"]})]}),e.era&&t.jsx("div",{className:"text-[10px] font-mono text-[#475569] mb-1",children:e.era}),t.jsx("p",{className:"text-[#64748b] text-xs leading-relaxed",children:e.description}),t.jsxs("div",{className:"mt-2 text-[10px] font-mono text-[#475569] border-l-2 pl-2",style:{borderColor:e.color+"55"},children:["ðŸ’¡ ",e.lesson]})]})]})})}function re({title:e,subtitle:n,scenarios:s,current:r,onSelect:o}){return t.jsxs("div",{children:[t.jsxs("div",{className:"mb-3",children:[t.jsx("h3",{className:"text-white font-bold text-sm",children:e}),n&&t.jsx("p",{className:"text-[#475569] text-xs mt-0.5",children:n})]}),t.jsx("div",{className:"flex flex-col gap-2",children:s.map(a=>t.jsx(gt,{scenario:a,current:r,onSelect:o},a.id))})]})}function yt({current:e,onSelect:n,onClose:s}){return t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/75 backdrop-blur-sm",children:t.jsxs("div",{className:"bg-[#0d0d14] border border-[#1e1e2e] rounded-2xl p-6 max-w-2xl w-full mx-4 max-h-[92vh] overflow-y-auto shadow-2xl",children:[t.jsxs("div",{className:"flex items-start justify-between mb-6",children:[t.jsxs("div",{children:[t.jsx("h2",{className:"text-white font-bold text-xl font-mono",children:"Choose Scenario"}),t.jsx("p",{className:"text-[#64748b] text-sm mt-1",children:"Sandbox: experiment freely. Historical Crises: can you do better than history did?"})]}),t.jsx("button",{onClick:s,className:"text-[#475569] hover:text-white text-xl ml-4 flex-shrink-0",children:"âœ•"})]}),t.jsxs("div",{className:"flex flex-col gap-6",children:[t.jsx(re,{title:"ðŸ§ª Sandbox",subtitle:"No time limit. Experiment with policy freely.",scenarios:xt,current:e,onSelect:r=>{n(r),s()}}),t.jsx("div",{className:"border-t border-[#1e1e2e] pt-6",children:t.jsx(re,{title:"ðŸ“œ Historical Crises â€” Can You Do Better?",subtitle:"Real economic crises, simulated. Each has objectives and a report card. Your outcome is compared to what actually happened.",scenarios:bt,current:e,onSelect:r=>{n(r),s()}})})]}),t.jsx("div",{className:"mt-4 text-center text-[#334155] text-xs font-mono",children:"Changing scenario resets the simulation"})]})})}const vt={monopoly_forming:{title:"Monopoly Alert",emoji:"ðŸ¢",body:"One business now controls over 60% of its market. Without competition, prices rise and quality drops.",realWorld:"Standard Oil controlled 91% of US oil in 1904. The Sherman Antitrust Act (1890) broke it up. Today, similar debates surround Big Tech.",color:"#ef4444"},high_inequality:{title:"Inequality Spike",emoji:"ðŸ“Š",body:"Wealth concentration is extreme. The Gini coefficient measures this: 0 = perfect equality, 1 = one person owns everything.",realWorld:"The US Gini is ~0.41. Scandinavia: ~0.28. Brazil: ~0.53. High inequality correlates with lower social mobility and higher crime.",color:"#f59e0b"},high_unemployment:{title:"Unemployment Crisis",emoji:"ðŸ“‰",body:"Mass unemployment creates a vicious cycle: fewer workers â†’ less spending â†’ fewer sales â†’ more layoffs.",realWorld:"Keynes' insight: in a recession, government spending can break this cycle by creating demand when the private sector won't.",color:"#ef4444"},inflation_spiral:{title:"Inflation Warning",emoji:"ðŸ”¥",body:"Prices are rising faster than wages. Your money buys less each day. The purchasing power of savings erodes.",realWorld:"Zimbabwe's hyperinflation (2008) reached 89.7 sextillion % monthly. The cure: independent central banks that raise rates.",color:"#f97316"},min_wage_tradeoff:{title:"Minimum Wage Tradeoff",emoji:"âš–ï¸",body:"A higher minimum wage raised living standards â€” but some businesses can no longer afford to hire.",realWorld:"Seattle's $15 minimum wage (2015) study: restaurant employment rose in some areas, fell in others. Context matters enormously.",color:"#6366f1"},budget_surplus:{title:"Fiscal Surplus!",emoji:"ðŸ’°",body:"Tax revenue exceeds spending. The government can pay down debt or invest in future growth.",realWorld:"The US ran surpluses 1998-2001. Norway's oil fund (built from surpluses) now exceeds $1.4 trillion.",color:"#22c55e"},stagnation:{title:"Stagflation Risk",emoji:"ðŸ˜°",body:"The economy is shrinking AND unemployment is rising â€” the worst of both worlds. Traditional policy tools conflict.",realWorld:"The 1970s oil crisis created stagflation. Volcker killed it (1980) by raising interest rates to 20% â€” causing a painful recession.",color:"#8b5cf6"},poverty_trap:{title:"Poverty Trap",emoji:"ðŸª¤",body:"Workers in poverty can't afford better nutrition, education, or healthcare â€” which keeps them in poverty.",realWorld:"The poverty trap: every dollar earned reduces welfare by $1. Effective marginal tax rates for the poor can exceed 80%.",color:"#ef4444"},dutch_disease:{title:"Resource Dependency",emoji:"â›½",body:"One sector dominates, crowding out others. High-earning sectors attract all workers, leaving other industries struggling.",realWorld:`The "Dutch Disease": Netherlands' 1960s natural gas discovery boosted the guilder, making exports uncompetitive.`,color:"#f59e0b"},ubi_effect:{title:"UBI Effect Observed",emoji:"ðŸŽ¯",body:"Universal Basic Income is reducing poverty and providing security. Some people are taking more risks â€” starting businesses.",realWorld:"Finland's UBI experiment (2017-18): recipients reported better wellbeing, mental health improved. Employment was neutral.",color:"#22c55e"}};function wt({insight:e,onDismiss:n}){const[s,r]=c.useState(!1);if(c.useEffect(()=>{e&&r(!0)},[e]),!e||!s)return null;const o=vt[e.id]||{title:e.title,emoji:"ðŸ’¡",body:e.body,realWorld:e.realWorld,color:"#6366f1"},a=()=>{r(!1),setTimeout(()=>n==null?void 0:n(),300)};return t.jsx("div",{className:`fixed bottom-6 right-6 z-40 max-w-sm transition-all duration-300 ${s?"opacity-100 translate-y-0":"opacity-0 translate-y-4"}`,children:t.jsx("div",{className:"bg-[#0d0d14] border rounded-xl p-4 shadow-2xl",style:{borderColor:o.color+"66"},children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("span",{className:"text-2xl flex-shrink-0",children:o.emoji}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between mb-1",children:[t.jsx("h4",{className:"text-white font-bold text-sm",children:o.title}),t.jsx("button",{onClick:a,className:"text-[#475569] hover:text-white text-sm ml-2",children:"âœ•"})]}),t.jsx("p",{className:"text-[#94a3b8] text-xs leading-relaxed mb-2",children:o.body}),t.jsxs("div",{className:"text-[10px] text-[#64748b] leading-relaxed border-l-2 pl-2 italic",style:{borderColor:o.color+"66"},children:["ðŸŒ ",o.realWorld]}),t.jsxs("div",{className:"text-[9px] text-[#334155] mt-2 font-mono",children:["Year ",e.year," Â· ",e.id]})]})]})})})}const jt={working:"Employed",unemployed:"Unemployed",child:"Child",retired:"Retired",owner:"Business Owner",dead:"Deceased"},kt={working:"#22c55e",unemployed:"#ef4444",child:"#94a3b8",retired:"#64748b",owner:"#f59e0b",dead:"#374151"};function Nt({agent:e,onClose:n}){if(!e)return null;const s=Math.floor(e.age/52),r=ue(e.wealth);return t.jsxs("div",{className:"fixed top-20 left-1/2 -translate-x-1/2 z-40 bg-[#0d0d14] border border-[#1e1e2e] rounded-xl p-4 shadow-2xl max-w-xs w-full",children:[t.jsxs("div",{className:"flex items-center justify-between mb-3",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("div",{className:"w-4 h-4 rounded-full border border-white/20",style:{backgroundColor:r}}),t.jsxs("span",{className:"text-white font-bold font-mono text-sm",children:["Agent #",e.id]})]}),t.jsx("button",{onClick:n,className:"text-[#475569] hover:text-white text-sm",children:"âœ•"})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5 text-xs mb-3",children:[t.jsx(N,{label:"Age",value:`${s} yrs`}),t.jsx(N,{label:"Status",value:jt[e.state]||e.state,color:kt[e.state]}),t.jsx(N,{label:"Wealth",value:`$${Math.round(e.wealth)}`,color:r}),t.jsx(N,{label:"Wage",value:e.wage>0?`$${e.wage.toFixed(1)}/tick`:"â€”"}),t.jsx(N,{label:"Skill",value:`${(e.skill*100).toFixed(0)}%`}),t.jsx(N,{label:"Education",value:`${(e.education*100).toFixed(0)}%`}),t.jsx(N,{label:"Health",value:`${(e.health*100).toFixed(0)}%`}),t.jsx(N,{label:"Happiness",value:`${(e.happiness*100).toFixed(0)}%`,color:e.happiness>.6?"#22c55e":e.happiness<.3?"#ef4444":"#e2e8f0"}),e.jobSector&&t.jsx(N,{label:"Sector",value:e.jobSector}),t.jsx(N,{label:"Class",value:e.socialClass,color:e.socialClass==="rich"?"#f59e0b":e.socialClass==="poor"?"#ef4444":"#e2e8f0"})]}),e.events&&e.events.length>0&&t.jsxs("div",{children:[t.jsx("div",{className:"text-[#475569] text-[10px] uppercase tracking-wider font-mono mb-1.5",children:"Life History"}),t.jsx("ul",{className:"space-y-0.5 max-h-24 overflow-y-auto",children:e.events.map((o,a)=>t.jsxs("li",{className:"text-[10px] text-[#64748b] font-mono leading-tight",children:["â€¢ ",o]},a))})]})]})}function N({label:e,value:n,color:s}){return t.jsxs(t.Fragment,{children:[t.jsx("span",{className:"text-[#475569] font-mono",children:e}),t.jsx("span",{className:"font-mono font-medium",style:{color:s||"#e2e8f0"},children:n})]})}function Ct(e){return e<100?"<$100":e<300?"$100-300":e<800?"$300-800":e<2e3?"$800-2K":e<5e3?"$2K-5K":">$5K"}const ae=["<$100","$100-300","$300-800","$800-2K","$2K-5K",">$5K"],St=["#ef4444","#f97316","#eab308","#22c55e","#06b6d4","#f59e0b"];function Tt({agents:e}){const n=c.useMemo(()=>{if(!(e!=null&&e.length))return[];const r={};ae.forEach(o=>{r[o]=0});for(const o of e){if(!o.alive)continue;const a=Ct(o.wealth);r[a]=(r[a]||0)+1}return ae.map((o,a)=>({name:o,count:r[o]||0,fill:St[a]}))},[e]),s=c.useMemo(()=>{if(!(e!=null&&e.length))return[];const r=e.filter(o=>o.alive).map(o=>Math.max(0,o.wealth));return Ue(r,20)},[e]);return t.jsxs("div",{className:"flex flex-col gap-3",children:[t.jsxs("div",{children:[t.jsx("div",{className:"text-[#64748b] text-xs uppercase tracking-wider font-mono mb-2",children:"Wealth Distribution"}),t.jsx("div",{className:"h-28",children:t.jsx(O,{width:"100%",height:"100%",children:t.jsxs(Re,{data:n,margin:{top:0,right:0,bottom:0,left:-20},children:[t.jsx(Z,{dataKey:"name",tick:{fontSize:8,fill:"#475569",fontFamily:"monospace"},axisLine:!1,tickLine:!1}),t.jsx(Q,{tick:{fontSize:8,fill:"#475569",fontFamily:"monospace"},axisLine:!1,tickLine:!1}),t.jsx(ee,{contentStyle:{background:"#12121a",border:"1px solid #1e1e2e",fontSize:10},labelStyle:{color:"#e2e8f0"},itemStyle:{color:"#6366f1"}}),t.jsx(Ae,{dataKey:"count",radius:[2,2,0,0],children:n.map((r,o)=>t.jsx(Fe,{fill:r.fill},o))})]})})})]}),s.length>2&&t.jsxs("div",{children:[t.jsx("div",{className:"text-[#64748b] text-xs uppercase tracking-wider font-mono mb-2",children:"Lorenz Curve"}),t.jsx("div",{className:"h-24",children:t.jsx(O,{width:"100%",height:"100%",children:t.jsxs(Be,{data:s,margin:{top:0,right:0,bottom:0,left:-20},children:[t.jsx(Z,{dataKey:"population",tick:{fontSize:8,fill:"#475569"},axisLine:!1,tickLine:!1,tickFormatter:r=>r+"%"}),t.jsx(Q,{tick:{fontSize:8,fill:"#475569"},axisLine:!1,tickLine:!1,tickFormatter:r=>r+"%"}),t.jsx(te,{data:[{population:0,perfect:0},{population:100,perfect:100}],type:"linear",dataKey:"perfect",stroke:"#334155",strokeWidth:1,dot:!1,strokeDasharray:"3 3"}),t.jsx(te,{type:"monotone",dataKey:"wealth",stroke:"#6366f1",strokeWidth:1.5,dot:!1,isAnimationActive:!1}),t.jsx(ee,{contentStyle:{background:"#12121a",border:"1px solid #1e1e2e",fontSize:10},formatter:r=>r.toFixed(1)+"%"})]})})}),t.jsx("div",{className:"text-[10px] text-[#334155] text-center font-mono",children:"Area between lines = Gini coefficient"})]})]})}function Pt({objectives:e=[],scenarioDurationYears:n,year:s,scenarioName:r}){if(!e.length)return t.jsxs("div",{className:"text-[#334155] text-xs font-mono p-2 text-center",children:["No objectives in sandbox mode.",t.jsx("br",{}),t.jsx("span",{className:"text-[#475569]",children:"Pick a Historical Crisis for a timed challenge."})]});const o=n?Math.max(0,n-(s||0)):null,a=e.filter(i=>i.completed).length;return t.jsxs("div",{className:"flex flex-col gap-2",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"text-[#64748b] text-xs font-mono",children:[a,"/",e.length," objectives met"]}),o!==null&&t.jsxs("div",{className:`text-xs font-mono font-bold ${o<3?"text-[#ef4444]":"text-[#94a3b8]"}`,children:[o,"yr left"]})]}),n&&t.jsx("div",{className:"w-full bg-[#1e1e2e] rounded-full h-1",children:t.jsx("div",{className:"h-1 rounded-full transition-all duration-500 bg-[#6366f1]",style:{width:`${Math.min(100,(s||0)/n*100)}%`}})}),e.map(i=>{const l=i.completed?"#22c55e":i.met?"#f59e0b":"#ef4444",u=i.completed?"Complete":i.met?"Activeâ€¦":"Not met";return t.jsxs("div",{className:"bg-[#12121a] border rounded-lg p-3",style:{borderColor:l+"44"},children:[t.jsxs("div",{className:"flex items-start justify-between gap-2 mb-1.5",children:[t.jsxs("div",{className:"flex items-center gap-1.5 text-xs font-mono text-[#e2e8f0]",children:[t.jsx("span",{children:i.icon}),t.jsx("span",{children:i.label})]}),t.jsx("span",{className:"text-[10px] font-mono flex-shrink-0",style:{color:l},children:u})]}),t.jsx("div",{className:"text-[10px] text-[#475569] mb-1.5",children:i.description}),t.jsx("div",{className:"w-full bg-[#0a0a0f] rounded-full h-1.5 mb-1",children:t.jsx("div",{className:"h-1.5 rounded-full transition-all duration-500",style:{width:`${Math.round(i.progress*100)}%`,backgroundColor:l}})}),i.met&&!i.completed&&i.sustainProgress>0&&t.jsxs("div",{className:"text-[9px] text-[#475569] font-mono",children:["Sustaining: ",Math.round(i.sustainProgress*100),"%"]}),!i.completed&&t.jsxs("div",{className:"text-[9px] text-[#334155] mt-1 leading-tight italic",children:["ðŸ’¡ ",i.tip]})]},i.id)})]})}function Mt(e){const n=e.id,s=e.effectOverride||{},r=[];return s.demandMultiplier!==void 0&&r.push(s.demandMultiplier>.7?"â†‘ GDP recovery":"â†“ GDP contraction"),s.wealthCrashPhase!==void 0&&r.push(s.wealthCrashPhase>.5?"â†— Softer crash":"â†˜ Hard crash"),s.deathRateMultiplier!==void 0&&r.push(s.deathRateMultiplier>2?"â†‘â†‘ Deaths":"â†‘ Fewer deaths"),s.techProductivityMultiplier!==void 0&&(r.push(s.techProductivityMultiplier>1.5?"â†‘ GDP spike":"â†’ Moderate growth"),r.push(s.otherJobsAutomatedRate>.1?"â†“â†“ Jobs lost":"â†“ Some jobs lost")),s.foodSupplyMultiplier!==void 0&&r.push(s.foodPriceMultiplier>1.8?"â†‘â†‘ Food prices":"â†‘ Food prices"),e.govDebtPenalty&&r.push(`â†‘ Debt +${e.govDebtPenalty}`),n==="do_nothing"&&(r.push("â†’ Default market response"),r.push("? Outcome uncertain")),r}function It({choice:e,selected:n,onSelect:s}){const r=Mt(e),o=e.id==="do_nothing";return t.jsx("button",{onClick:()=>s(e.id),className:`w-full text-left p-4 rounded-xl border-2 transition-all ${n?"border-[#6366f1] bg-[#6366f111]":o?"border-[#334155] border-dashed bg-[#12121a] hover:border-[#475569]":"border-[#1e1e2e] bg-[#12121a] hover:border-[#334155] hover:bg-[#1a1a28]"}`,children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("span",{className:"text-2xl flex-shrink-0 mt-0.5",children:e.emoji}),t.jsxs("div",{className:"flex-1",children:[t.jsx("div",{className:"font-bold text-white text-sm mb-1",children:e.label}),t.jsx("p",{className:"text-[#94a3b8] text-xs leading-relaxed mb-2",children:e.description}),t.jsxs("div",{className:"flex items-start gap-1.5 mb-2",children:[t.jsx("span",{className:"text-[#f59e0b] text-[10px] flex-shrink-0 mt-0.5",children:"âš "}),t.jsx("span",{className:"text-[#f59e0b] text-[10px] leading-relaxed",children:e.tradeoff})]}),r.length>0&&t.jsx("div",{className:"flex flex-wrap gap-1",children:r.map((a,i)=>t.jsx("span",{className:`text-[9px] font-mono px-1.5 py-0.5 rounded ${a.startsWith("â†‘")||a.startsWith("â†—")?"bg-[#22c55e22] text-[#22c55e]":a.startsWith("â†“")||a.startsWith("â†˜")?"bg-[#ef444422] text-[#ef4444]":"bg-[#1e1e2e] text-[#64748b]"}`,children:a},i))})]})]})})}function Et({event:e,onChoose:n}){var u,d;const[s,r]=c.useState(null),[o,a]=c.useState(!1);if(!e)return null;const i=()=>{if(s){if(!o){a(!0);return}n(e.id,s)}},l=(u=e.choices)==null?void 0:u.find(f=>f.id===s);return t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm",children:t.jsxs("div",{className:"bg-[#0d0d14] border border-[#334155] rounded-2xl p-6 max-w-xl w-full mx-4 max-h-[90vh] overflow-y-auto shadow-2xl",children:[t.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[t.jsx("span",{className:"text-4xl",children:e.icon}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-white font-bold text-lg",children:e.name}),t.jsx("p",{className:"text-[#94a3b8] text-sm",children:e.description})]})]}),t.jsxs("div",{className:"border-t border-[#1e1e2e] pt-4 mb-4",children:[t.jsx("p",{className:"text-[#64748b] text-xs font-mono uppercase tracking-wider mb-3",children:"âš¡ Simulation paused â€” your decision required"}),t.jsx("div",{className:"flex flex-col gap-2",children:(d=e.choices)==null?void 0:d.map(f=>t.jsx(It,{choice:f,selected:s===f.id,onSelect:r},f.id))})]}),o&&l&&t.jsxs("div",{className:"mb-4 p-3 bg-[#1e1e2e] rounded-lg border border-[#334155]",children:[t.jsx("div",{className:"text-[#64748b] text-[10px] uppercase tracking-wider font-mono mb-1",children:"ðŸ“š What history did"}),t.jsx("p",{className:"text-[#94a3b8] text-xs leading-relaxed italic",children:l.historicalNote})]}),t.jsx("button",{onClick:i,disabled:!s,className:`w-full py-3 rounded-xl font-mono font-bold text-sm transition-colors ${s?"bg-[#6366f1] hover:bg-[#818cf8] text-white":"bg-[#1e1e2e] text-[#475569] cursor-not-allowed"}`,children:s?o?"â–¶ Apply and continue":"Confirm â€” see what history did â†’":"Select a response"})]})})}const Rt={greatDepression:{summary:"The US experienced 10 years of contraction. GDP fell 46% peak-to-trough. Unemployment peaked at 25% in 1933. Deflation wiped out savings.",turningPoint:"FDR's New Deal (1933): bank reform, work programs (CCC, WPA), agricultural relief, and abandoning the gold standard.",whatWorked:"Government spending restarted demand. Banking reform restored confidence. Devaluing the dollar stopped deflation.",whatFailed:"Initial Hoover austerity and Smoot-Hawley tariffs deepened the slump. Balanced-budget orthodoxy was catastrophically wrong.",historicalGrade:"D+",metrics:{gdpChangePercent:-46,peakUnemployment:25,inflationAvg:-6,gini:.63,povertyRate:35,recoveryYears:10},quote:'"The only thing we have to fear is fear itself." â€” FDR, 1933'},weimarHyperinflation:{summary:"Germany printed money to pay WWI reparations. By Nov 1923 a loaf of bread cost 200 billion marks. The middle class was wiped out.",turningPoint:"The Rentenmark (Nov 1923): a new currency backed by land assets, issued by an independent body. Printing stopped cold.",whatWorked:"Completely stopping money creation. Issuing a credible new currency. International loans (Dawes Plan) stabilized reparations.",whatFailed:"There was no painless exit. Savings were permanently destroyed. The political fallout helped fuel the rise of extremism.",historicalGrade:"C",metrics:{gdpChangePercent:-25,peakUnemployment:30,inflationAvg:29500,gini:.7,povertyRate:45,recoveryYears:6},quote:'"Inflation is the most important single factor in the politico-economic history of the Weimar Republic." â€” Adam Fergusson'},stagflation1970s:{summary:"OPEC oil embargo (1973) triggered both high inflation AND high unemployment simultaneously â€” violating Keynesian assumptions.",turningPoint:"Volcker Shock (1979â€“82): Federal Reserve raised rates to 20%, deliberately causing a recession to break inflationary expectations.",whatWorked:"Aggressive interest rate hikes eventually tamed inflation. Supply-side reforms improved productivity.",whatFailed:"Wage-price controls (Nixon 1971) temporarily masked inflation then made it worse. Easy money in the early 70s was a mistake.",historicalGrade:"C+",metrics:{gdpChangePercent:-3,peakUnemployment:13,inflationAvg:11,gini:.4,povertyRate:15,recoveryYears:8},quote:'"Inflation is always and everywhere a monetary phenomenon." â€” Milton Friedman'},crisisOf2008:{summary:"US housing bubble collapsed. Lehman Brothers failed Sep 2008. Global credit froze. Worst recession since the Great Depression.",turningPoint:"TARP bank bailouts ($700B), Fed QE programs ($4T), Obama stimulus ($787B). Slow but sustained recovery 2009â€“2019.",whatWorked:"Massive fiscal stimulus, quantitative easing, and bank recapitalization prevented a second Great Depression.",whatFailed:"Austerity in Europe caused a double-dip recession. Too little debt relief for homeowners prolonged household balance sheet repair.",historicalGrade:"B-",metrics:{gdpChangePercent:-4.3,peakUnemployment:10,inflationAvg:1.5,gini:.47,povertyRate:15,recoveryYears:6},quote:'"We came very close to a complete collapse of the financial system." â€” Ben Bernanke'},japanLostDecade:{summary:"Japan's asset bubble burst in 1991. Despite near-zero rates and stimulus, GDP stagnated for 20+ years. Deflation became entrenched.",turningPoint:"Abenomics (2012): aggressive QE, fiscal stimulus, structural reforms. Partially effective â€” ended deflation but growth remained weak.",whatWorked:"Eventually: currency devaluation, quantitative easing at scale, negative interest rates.",whatFailed:"Years of half-measures and zombie bank forbearance. Failure to force bad debt write-offs kept the economy in stasis.",historicalGrade:"D",metrics:{gdpChangePercent:10,peakUnemployment:5.5,inflationAvg:-.2,gini:.34,povertyRate:16,recoveryYears:20},quote:`"Japan's experience suggests that it's very hard to escape deflation once it becomes entrenched." â€” Ben Bernanke`},nordicMiracle:{summary:"Nordic countries (esp. Sweden 1990s) combined high taxes, strong unions, universal welfare, and open markets into sustained prosperity.",turningPoint:"Sweden's 1990s bank crisis resolution: swift bank nationalization, transparent debt writedowns, then re-privatization. Full recovery in 3 years.",whatWorked:"Universal education and healthcare create a productive workforce. Strong safety nets allow risk-taking. Transparent institutions reduce corruption.",whatFailed:"Model requires high trust, homogeneity, and strong institutions to function. Difficult to replicate in larger, more diverse economies.",historicalGrade:"A",metrics:{gdpChangePercent:35,peakUnemployment:8,inflationAvg:2.1,gini:.27,povertyRate:8,recoveryYears:3},quote:`"The Nordic model is not socialism. It's a highly competitive market economy with strong social insurance." â€” Daron Acemoglu`}};function At(e){return Rt[e]||null}const he={"A+":"#22c55e",A:"#22c55e",B:"#84cc16",C:"#eab308",D:"#f97316",F:"#ef4444"};function _({label:e,score:n}){const s=n>=70?"#22c55e":n>=45?"#eab308":"#ef4444";return t.jsxs("div",{children:[t.jsxs("div",{className:"flex justify-between items-center mb-1 text-xs font-mono",children:[t.jsx("span",{className:"text-[#94a3b8]",children:e}),t.jsxs("span",{style:{color:s},children:[n,"/100"]})]}),t.jsx("div",{className:"w-full bg-[#1e1e2e] rounded-full h-1.5",children:t.jsx("div",{className:"h-1.5 rounded-full transition-all duration-700",style:{width:`${n}%`,backgroundColor:s}})})]})}function Ft({obj:e}){const n=e.completed?"âœ…":e.met?"ðŸ”„":"âŒ",s=e.completed?"#22c55e":e.met?"#f59e0b":"#ef4444";return t.jsxs("div",{className:"flex items-start gap-2 py-1.5 border-b border-[#1e1e2e] last:border-0",children:[t.jsx("span",{className:"text-sm flex-shrink-0 mt-0.5",children:n}),t.jsxs("div",{className:"flex-1",children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("span",{className:"text-xs font-mono text-[#e2e8f0]",children:[e.icon," ",e.label]}),t.jsx("span",{className:"text-xs font-mono",style:{color:s},children:e.completed?"Done":e.met?"In progress":`${Math.round(e.progress*100)}%`})]}),t.jsx("div",{className:"text-[10px] text-[#475569] mt-0.5",children:e.description})]})]})}function Bt({playerOutcome:e,historicalOutcome:n}){var r;if(!n)return null;const s=[{label:"GDP Change",player:`${e.gdpChangePercent>0?"+":""}${e.gdpChangePercent}%`,history:`${n.metrics.gdpChangePercent}%`,betterIfHigher:!0,playerVal:e.gdpChangePercent,histVal:n.metrics.gdpChangePercent},{label:"Peak Unemployment",player:`${e.peakUnemployment}%`,history:`${n.metrics.peakUnemployment}%`,betterIfHigher:!1,playerVal:e.peakUnemployment,histVal:n.metrics.peakUnemployment},{label:"Avg Inflation",player:`${e.inflationAvg}%`,history:`${n.metrics.inflationAvg}%`,betterIfHigher:null,playerVal:Math.abs(e.inflationAvg),histVal:Math.abs(n.metrics.inflationAvg)},{label:"Gini Coefficient",player:e.gini.toFixed(2),history:n.metrics.gini.toFixed(2),betterIfHigher:!1,playerVal:e.gini,histVal:n.metrics.gini},{label:"Poverty Rate",player:`${e.povertyRate}%`,history:`${n.metrics.povertyRate}%`,betterIfHigher:!1,playerVal:e.povertyRate,histVal:n.metrics.povertyRate}];return t.jsxs("div",{children:[t.jsx("div",{className:"text-[#64748b] text-xs uppercase tracking-wider font-mono mb-3",children:"You vs History"}),t.jsxs("div",{className:"bg-[#0d0d14] rounded-xl overflow-hidden border border-[#1e1e2e]",children:[t.jsxs("div",{className:"grid grid-cols-3 text-[10px] font-mono text-[#475569] px-3 py-1.5 border-b border-[#1e1e2e]",children:[t.jsx("span",{children:"Metric"}),t.jsx("span",{className:"text-center text-[#6366f1]",children:"You"}),t.jsx("span",{className:"text-center",children:"History"})]}),s.map(o=>{let a="#e2e8f0";return o.betterIfHigher===!0?a=o.playerVal>=o.histVal?"#22c55e":"#ef4444":o.betterIfHigher===!1&&(a=o.playerVal<=o.histVal?"#22c55e":"#ef4444"),t.jsxs("div",{className:"grid grid-cols-3 px-3 py-1.5 text-xs font-mono border-b border-[#0a0a0f] last:border-0",children:[t.jsx("span",{className:"text-[#64748b]",children:o.label}),t.jsx("span",{className:"text-center font-bold",style:{color:a},children:o.player}),t.jsx("span",{className:"text-center text-[#475569]",children:o.history})]},o.label)})]}),t.jsxs("div",{className:"mt-2 flex items-center justify-between text-xs font-mono text-[#475569] px-1",children:[t.jsxs("span",{children:["History's grade: ",t.jsx("span",{style:{color:he[n.historicalGrade]||"#94a3b8"},className:"font-bold",children:n.historicalGrade})]}),t.jsxs("span",{className:"text-[10px] italic",children:['"',(r=n.quote)==null?void 0:r.slice(0,50),'â€¦"']})]})]})}function Dt({report:e,onRetry:n,onNextScenario:s}){var i;if(!e)return null;const r=At(e.scenarioId),o=he[e.grade]||"#94a3b8",a=r&&e.finalScore>({"A+":95,A:85,B:70,C:55,D:40,F:20}[r.historicalGrade]||50);return t.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/85 backdrop-blur-sm",children:t.jsxs("div",{className:"bg-[#0d0d14] border border-[#1e1e2e] rounded-2xl p-6 max-w-lg w-full mx-4 max-h-[92vh] overflow-y-auto shadow-2xl",children:[t.jsxs("div",{className:"text-center mb-5",children:[t.jsx("div",{className:"text-6xl font-bold font-mono mb-1",style:{color:o},children:e.grade}),t.jsx("div",{className:"text-white font-bold text-lg",children:e.scenarioName}),t.jsxs("div",{className:"text-[#64748b] text-sm",children:["Year ",e.year," Â· Score ",e.finalScore,"/100"]}),a&&t.jsx("div",{className:"mt-2 text-[#22c55e] text-sm font-mono",children:"ðŸ† You did better than history!"})]}),t.jsxs("div",{className:"bg-[#12121a] rounded-xl p-4 mb-4 flex flex-col gap-2.5",children:[t.jsx(_,{label:"Equality",score:e.domains.equality.score}),t.jsx(_,{label:"Growth",score:e.domains.growth.score}),t.jsx(_,{label:"Stability",score:e.domains.stability.score})]}),((i=e.objectives)==null?void 0:i.length)>0&&t.jsxs("div",{className:"bg-[#12121a] rounded-xl p-4 mb-4",children:[t.jsx("div",{className:"text-[#64748b] text-xs uppercase tracking-wider font-mono mb-2",children:"Objectives"}),e.objectives.map(l=>t.jsx(Ft,{obj:l},l.id))]}),r&&t.jsxs("div",{className:"bg-[#12121a] rounded-xl p-4 mb-4",children:[t.jsx(Bt,{playerOutcome:e.playerOutcome,historicalOutcome:r}),t.jsxs("div",{className:"mt-3 border-t border-[#1e1e2e] pt-3",children:[t.jsx("div",{className:"text-[10px] text-[#475569] font-mono uppercase tracking-wider mb-1",children:"What worked in history"}),t.jsx("p",{className:"text-[#64748b] text-xs leading-relaxed",children:r.whatWorked})]})]}),t.jsxs("div",{className:"flex gap-3",children:[t.jsx("button",{onClick:n,className:"flex-1 py-3 rounded-xl border border-[#1e1e2e] text-[#94a3b8] hover:border-[#6366f1] hover:text-[#6366f1] font-mono text-sm transition-colors",children:"â†º Try Again"}),t.jsx("button",{onClick:s,className:"flex-1 py-3 rounded-xl bg-[#6366f1] hover:bg-[#818cf8] text-white font-mono font-bold text-sm transition-colors",children:"Next Challenge â†’"})]})]})})}function Wt(e,n){const s={incomeTax:[0,.6],corporateTax:[0,.5],minWage:[0,50],ubi:[0,1e3],interestRate:[0,.2],educationFunding:[0,1],unemploymentBenefit:[0,500],printMoney:[0,100],wealthTax:[0,.05]};if(e in s){const[r,o]=s[e];return Ge(Number(n),r,o)}return n}const me="ecomsim_save";function Ht(e){try{localStorage.setItem(me+"_scenario",e)}catch{}}function _t(){try{return localStorage.getItem(me+"_scenario")||"freeMarket"}catch{return"freeMarket"}}const $t="modulepreload",Lt=function(e){return"/ecomsim/"+e},ie={},Ot=function(n,s,r){let o=Promise.resolve();if(s&&s.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),l=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));o=Promise.allSettled(s.map(u=>{if(u=Lt(u),u in ie)return;ie[u]=!0;const d=u.endsWith(".css"),f=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${f}`))return;const h=document.createElement("link");if(h.rel=d?"stylesheet":$t,d||(h.as="script"),h.crossOrigin="",h.href=u,l&&h.setAttribute("nonce",l),document.head.appendChild(h),d)return new Promise((m,p)=>{h.addEventListener("load",m),h.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${u}`)))})}))}function a(i){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=i,window.dispatchEvent(l),!l.defaultPrevented)throw i}return o.then(i=>{for(const l of i||[])l.status==="rejected"&&a(l.reason);return n().catch(a)})};let M=null,B=!1,$=[],L=null;const Gt="af_sky",Ut="onnx-community/Kokoro-82M-v1.0-ONNX",pe={monopoly_forming:"Warning. One company now dominates the market. Without competition, prices are rising and innovation is slowing.",high_inequality:"Inequality has reached extreme levels. The Gini coefficient indicates the top few now own most of the wealth.",high_unemployment:"Mass unemployment is spreading. A vicious cycle: fewer workers means less spending, which means even more layoffs.",inflation_spiral:"Inflation warning. Prices are rising faster than wages. Your population's purchasing power is eroding.",min_wage_tradeoff:"Minimum wage tradeoff observed. Living standards improved, but some small businesses can no longer afford to hire.",budget_surplus:"Fiscal surplus achieved. Tax revenue now exceeds government spending.",stagnation:"Stagflation risk. The economy is shrinking while unemployment rises â€” the classic policy dilemma.",poverty_trap:"Poverty trap forming. Workers in poverty cannot afford education or healthcare, keeping them trapped.",ubi_effect:"Universal Basic Income is reducing poverty. Some residents are using the security to start new businesses.",pandemic:"A pandemic has struck. Health is dropping, businesses are closing, and workers are staying home.",cropFailure:"Crop failure. Poor harvests are causing food prices to spike. The poorest citizens are suffering most.",techBreakthrough:"Technology breakthrough! Productivity in the tech sector has doubled â€” but automation is threatening other jobs.",financialBubble:"A financial bubble is growing. Asset prices are inflating rapidly â€” and history suggests what comes next.",corruption:"Corruption scandal. Government tax revenue is being diverted. Public services are beginning to collapse.",immigrationWave:"An immigration wave has arrived. Skilled workers are boosting productivity, but job competition is increasing.",recession:"Recession begins. Consumer demand is falling, businesses are struggling, and unemployment is rising.",boom:"Economic boom! Consumer confidence has surged. Businesses are hiring and wages are growing."};async function xe(){if(M)return M;if(B)return new Promise(e=>$.push(e));B=!0;try{const{KokoroTTS:e}=await Ot(async()=>{const{KokoroTTS:n}=await import("./kokoro-CqRZUw5m.js");return{KokoroTTS:n}},[]);return M=await e.from_pretrained(Ut,{dtype:"q4",device:"wasm"}),$.forEach(n=>n(M)),$=[],B=!1,M}catch(e){return console.warn("[Narrator] Failed to load Kokoro TTS:",e),B=!1,null}}function qt(){return L||(L=new(window.AudioContext||window.webkitAudioContext)),L}let R=null;async function D(e,n={}){if(e){be();try{const s=await xe();if(!s)return;const r=await s.generate(e,{voice:n.voice||Gt}),o=qt(),a=o.createBuffer(1,r.audio.length,r.sampling_rate);a.copyToChannel(r.audio,0);const i=o.createBufferSource();return i.buffer=a,n.rate&&(i.playbackRate.value=n.rate),i.connect(o.destination),i.start(),R=i,new Promise(l=>{i.onended=()=>{R=null,l()}})}catch(s){console.warn("[Narrator] Narration error:",s)}}}function be(){if(R){try{R.stop()}catch{}R=null}}function zt(e){const n=pe[e];n&&D(n)}function Yt(e){const n=pe[e];n&&D(n)}function Vt(){xe()}function Kt(){return M!==null}function Jt(){const[e,n]=c.useState(!1),[s,r]=c.useState(!1),[o,a]=c.useState(!1),i=c.useRef(!1),l=c.useCallback(async()=>{n(!0),i.current=!0,r(!0),Vt();const m=setInterval(()=>{Kt()&&(a(!0),r(!1),clearInterval(m),D("Economy simulator narrator ready."))},500);setTimeout(()=>clearInterval(m),3e4)},[]),u=c.useCallback(()=>{n(!1),i.current=!1,be()},[]),d=c.useCallback(m=>{i.current&&zt(m)},[]),f=c.useCallback(m=>{i.current&&Yt(m)},[]),h=c.useCallback(m=>{i.current&&D(m)},[]);return{enabled:e,loading:s,ready:o,enable:l,disable:u,onInsight:d,onEvent:f,speak:h}}const le=["dashboard","objectives","policies","histogram"];function Xt(){var K,J;const e=Jt(),n=c.useRef(null),[s,r]=c.useState(null),[o,a]=c.useState(!1),[i,l]=c.useState(5),[u,d]=c.useState(_t()),[f,h]=c.useState(!1),[m,p]=c.useState(null),[g,v]=c.useState(null),[b,w]=c.useState("dashboard"),[k,T]=c.useState(null),[z,I]=c.useState(null);c.useEffect(()=>{const x=new Worker(new URL("/ecomsim/assets/simWorker-DMvQI_GG.js",import.meta.url),{type:"module"});return x.addEventListener("message",j=>{const{type:A,state:P,event:F,insight:X,report:Pe}=j.data;switch(A){case"STATE_UPDATE":r(P);break;case"EVENT":e.onEvent(F==null?void 0:F.type);break;case"CHOICE_REQUIRED":T(F),a(!0);break;case"INSIGHT":p(X),e.onInsight(X.id);break;case"SCENARIO_COMPLETE":I(Pe),a(!0);break}}),x.postMessage({type:"INIT",scenarioId:u}),n.current=x,()=>x.terminate()},[]);const y=c.useCallback(x=>{var j;(j=n.current)==null||j.postMessage(x)},[]),ge=c.useCallback(()=>{a(!0),y({type:"PAUSE"})},[y]),ye=c.useCallback(()=>{a(!1),y({type:"RESUME"})},[y]),H=c.useCallback(()=>{r(null),p(null),v(null),T(null),I(null),y({type:"RESET",scenarioId:u}),a(!1)},[y,u]),ve=c.useCallback(x=>{l(x),y({type:"SET_SPEED",speed:x})},[y]),we=c.useCallback((x,j)=>{const A=Wt(x,j);y({type:"SET_POLICY",policy:x,value:A}),r(P=>P&&{...P,policies:{...P.policies,[x]:A}})},[y]),je=c.useCallback(x=>{var j;d(x),Ht(x),r(null),p(null),v(null),T(null),I(null),y({type:"RESET",scenarioId:x}),a(!1),(j=U[x])!=null&&j.isHistorical&&w("objectives")},[y]),ke=c.useCallback(()=>{y({type:"SET_POLICY",policy:"_forceShock",value:!0})},[y]),Ne=c.useCallback((x,j)=>{T(null),y({type:"RESOLVE_CHOICE",eventId:x,choiceId:j}),a(!1)},[y]),Ce=c.useCallback(()=>{I(null),H()},[H]),Se=c.useCallback(()=>{I(null),h(!0)},[]),Y=((K=U[u])==null?void 0:K.name)||"Free Market",V=((J=s==null?void 0:s.objectives)==null?void 0:J.length)>0,Te=V?le:le.filter(x=>x!=="objectives");return t.jsxs("div",{className:"h-screen flex flex-col bg-[#0a0a0f] text-[#e2e8f0] overflow-hidden font-mono",children:[t.jsx(pt,{paused:o,speed:i,onPause:ge,onResume:ye,onReset:H,onSpeedChange:ve,onScenarioOpen:()=>h(!0),onShockMe:ke,scenarioName:Y,year:s==null?void 0:s.year,narratorEnabled:e.enabled,narratorLoading:e.loading,onNarratorToggle:e.enabled?e.disable:e.enable}),t.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[t.jsxs("div",{className:"flex-1 relative bg-[#0a0a0f]",children:[t.jsx(ot,{simState:s,onAgentClick:v,selectedAgentId:g==null?void 0:g.id}),g&&t.jsx(Nt,{agent:g,onClose:()=>v(null)})]}),t.jsxs("div",{className:"w-72 flex flex-col border-l border-[#1e1e2e] bg-[#0a0a0f]",children:[t.jsx("div",{className:"flex border-b border-[#1e1e2e]",children:Te.map(x=>t.jsx("button",{onClick:()=>w(x),className:`flex-1 py-2 text-xs font-mono capitalize transition-colors ${b===x?"text-[#6366f1] border-b border-[#6366f1]":"text-[#475569] hover:text-[#94a3b8]"}`,children:x==="objectives"&&V?`ðŸŽ¯ ${s.objectives.filter(j=>j.completed).length}/${s.objectives.length}`:x},x))}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-3",children:[b==="dashboard"&&t.jsx(lt,{metrics:s==null?void 0:s.metrics,market:s==null?void 0:s.market,activeEvents:s==null?void 0:s.activeEvents}),b==="objectives"&&t.jsx(Pt,{objectives:s==null?void 0:s.objectives,scenarioDurationYears:s==null?void 0:s.scenarioDurationYears,year:s==null?void 0:s.year,scenarioName:Y}),b==="policies"&&t.jsx(ht,{policies:s==null?void 0:s.policies,onPolicyChange:we}),b==="histogram"&&t.jsx(Tt,{agents:s==null?void 0:s.agents})]})]})]}),m&&t.jsx(wt,{insight:m,onDismiss:()=>p(null)}),k&&t.jsx(Et,{event:k,onChoose:Ne}),z&&t.jsx(Dt,{report:z,onRetry:Ce,onNextScenario:Se}),f&&t.jsx(yt,{current:u,onSelect:je,onClose:()=>h(!1)})]})}G.createRoot(document.getElementById("root")).render(t.jsx(De.StrictMode,{children:t.jsx(Xt,{})}));
